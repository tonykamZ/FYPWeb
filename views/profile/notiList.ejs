<head>
    <title>Notification List</title>
    <style>
        .card {
            background: rgb(250, 250, 250);
            border-radius: 2px;
            display: inline-block;
            margin: 1rem;
            position: relative;
            height: 150px;
            width: 700px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
            transition: all 0.3s cubic-bezier(.25, .8, .25, 1);
        }

        .card:hover {
            box-shadow: 0 5px 22px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);
        }

        h1 {
            font: 72px "Amatic SC", sans-serif;
            text-shadow: 2px 2px rgba(0, 0, 0, 0.3);
            margin-bottom: 15px;
        }

        #cross {
            position: absolute;
            cursor: pointer;
            top: 2%;
            left: 95%;
        }
    </style>
    <link href="https://fonts.googleapis.com/css?family=Amatic+SC|Raleway" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/styles.css">
</head>

<body>

    <% if(req.session.memberid){ %>
        <div>
            <br>
            <h1>Notification</h1>
            <% if(notiList.length==0){ %>
                <h3>There is no message here</h3>
                <% }else{ %>
                    <% notiList.forEach(function(n){ %>
                        <div class="card" id="<%= n.date %>">


                            <% var str=n.message.split("***") %>
                                <h6>
                                    <%= str[1] %>
                                </h6>
                                <h6 style="color: rgb(204, 0, 255); font-weight: bold;">
                                    <%= str[2] %>
                                </h6>
                                <small>
                                    <%= n.date %>
                                </small>

                                <form>
                                    <input value="<%= n.date %>" name="index" readonly hidden>
                                    <button id="cross" class="btn btn-outline-danger" type="button"
                                        onclick="del(this.form)"> <i class="fa fa-times"></i></button>
                                </form>

                        </div>
                        <% }); %>
                            <% } %>

        </div>

        <% }else{ %>

            <!-- visitor layout -->

            <h3><a href="/login">Login <li class="tag__item" style="cursor: pointer;"><i
                            class="fas fa-sign-in-alt mr-2"></i></li></a> to browse the notification
                details
            </h3>
            <!-- should store url session to nav back later -->

            <!-- visitor layout -->

            <% } %>

</body>

<script>
    async function del(form) {
        //alert(form['index'].value);
        document.getElementById(form['index'].value).style.display = 'none';

        var response = await fetch("/delete/notification?id=" + form['index'].value, { method: "POST" });


        if (response.ok) {
        } else {
            var msg = response.statusText;
            alert(msg);
        }
    }
</script>